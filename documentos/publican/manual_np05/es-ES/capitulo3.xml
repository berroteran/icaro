<?xml version='1.0' encoding='utf-8' ?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "manual_np05.ent">
%BOOK_ENTITIES;
]>
<chapter id="chap-manual_np05-programacion">
	<title>Ejemplos de programación</title>
	<section id="sect-manual_np05-Test_Chapter-Test_Section_1">
		<title>Primer programa</title>
		<para>
			Vamos a hacer el primer test de la placa ICARO &np05;; para ello necesitamos:
			<orderedlist>
				<listitem>
					<para>
						4 pilas AA de 1.5 volt y un portapilas para las 4
					</para>
				</listitem>
				<listitem>
					<para>
						1 motor de corriente continua que trabaje a 5 volt (cualquier motor de juguete está bien)
					</para>
				</listitem>
				<listitem>
					<para>
						1 placa ICARO &np05; y cable USB tipo D
					</para>
				</listitem>
				<listitem>
					<para>
						el software <command>&icaro-bloques;</command>
					</para>
				</listitem>

			</orderedlist>
            
		</para>
        <para>
        Conectar el motor y las pilas como se indca en el gráfico.
        <mediaobject>
		<imageobject>
			<imagedata fileref="./images/np05_2.svg" />
		</imageobject>
		</mediaobject>
        Los conectores P2 y P7 son para controlar motores de corriente continua (o un motor paso a paso del tipo unipolar).
        la placa ICARO &np05; trae incorporada un driver de potencia (puente H) de tipo L293D que puede manejar tensiones de hasta 36 volts. Sin
        embargo, en el esquema de la placa, la tensión se reduce a 5 volt para poder trabajar con motores de poca potencia (típicamente motores CC de juguetes).
        </para>
        <para>
        Por seguridad el driver de potencia tiene una alimentación separada del resto de la placa, por eso necesita pilas (o una fuente de hasta 12 volt) 
        para poder funcionar.
        </para>
        <para>
        En cuanto conectamos las pilas al conector P14, el LED amarillo (d4) se encenderá, indicando que esa sección tiene tensión.
		 <warning>
			<title>advertencia</title>
			 <para>
            Observar bien la disposición de los polos positivo y negativo en la placa; si bien hay diodos de protección por si nos equivocamos y ponemos los cables al revés,
            no es recomendable dejar mucho tiempo con la tensión invertida la placa. Si los LED de tensión (verde y amarillo) no encienden, revizar las conexiones.
			</para>
		</warning>
        </para>
<para>
Con el cableado ya conectado abrimos el programa <command>&icaro-bloques;</command>, y cargamos nuestro primer programa para icaro desde la carpeta 
<filename>ejemplos/hola_mundo.icr2</filename>.

        <mediaobject>
		<imageobject>
			<imagedata fileref="./images/Pantallazo-1.png" />
		</imageobject>
		</mediaobject>
        
</para> 

    </section>
	<section id="sect-manual_np05-Test_Chapter-Test_Section_2">
		<title>Servomotores</title>
		<para>
            Un servomotor (también llamado "servo") es un dispositivo similar a un motor de corriente continua 
            que tiene la capacidad de ubicarse en cualquier posición dentro de su rango de operación, 
            y mantenerse estable en dicha posición.
        </para>
        <para>
        Los servomotores hacen uso de la modulación por ancho de pulsos (PWM) para controlar 
        la dirección o posición de los motores de corriente continua. 
        La mayoría trabaja en la frecuencia de los cincuenta hercios, 
        así las señales PWM tendrán un periodo de veinte milisegundos. 
        La electrónica dentro del servomotor responderá al ancho de la señal modulada. 
        Si los circuitos dentro del servomotor reciben una señal de entre 0,5 a 1,4 milisegundos, este se moverá en sentido horario; entre 1,6 a 2 milisegundos moverá el servomotor en sentido antihorario; 1,5 milisegundos representa un estado neutro para los servomotores estándares.
        </para>
        <para>
                <mediaobject>
		<imageobject>
			<imagedata fileref="./images/Servomotor.png" />
		</imageobject>
		</mediaobject>
        Servomotor de aeromodelismo.
        </para>
        <para>
        La placa &np05; posee 5 conectores para servos, los cuales pueden ser controlados al mismo tiempo. Toman la tensión de alimentación
        de la misma fuente que el PIC, por lo tanto se pueden usar desde la alimentación de USB sin necesidad de baterías.
		 <warning>
			<title>Advertencia</title>
			 <para>
            Los servomotores necesitan voltaje para funcionar, la placa &np05;  provee 5 volts para su funcionamiento. Sin 
            embargo, si se inserta el conector del servo al revés (es un conector de 3 pines, donde el blanco suele ser la señal, rojo voltaje y negro masa)
            se puede quemar el servo. Observar el diagrama siguiente para ver la forma correcta de instalar un servo en la placa.
			</para>
		</warning>
        </para>

        <para>
        <mediaobject>
		<imageobject>
			<imagedata fileref="./images/np05_6.svg" />
		</imageobject>
		</mediaobject>
        Pines de conexión para servos
        </para>
    </section>
    	<section id="sect-manual_np05-conectando_servo">
		<title>Conectando un servomotor</title>
		<para>
            Para conectar un servo a la placa &np05; hay que seguir el diagrama siguiente. Generalmente el cable más claro es el que envía la señal de PWM
            (en los servos FUTABA S3003 es blanco), el del centro es el voltaje positivo (rojo) y el de la otra punta es la masa (negro). Pueden variar entre fabricantes los códigos de colores,
            pero en general se respeta el orden de los cables (positivo al medio).
        </para>
        <para>
        <mediaobject>
		<imageobject>
			<imagedata fileref="./images/np05_5.svg" />
		</imageobject>
		</mediaobject>
        Esquema de conexión de un servo.
        </para>
        <para>
        En el diagrama anterior se ve cómo el cable de señal PWM tiene que estar en el pin que está más cerca del micro controlador, el del medio es el voltaje positivo y el más alejado del micro es la masa.
        En ese esquema el servo está conectado al pin 1 de la placa, de ahí hacia abajo son los pines 2,3,4,5.
        </para>
        <para>
        Para una primera prueba de conexión de un servo, primero abramos el archivo en <filename>ejemplos/hola_mundo_servos.icr2</filename> y lo compilemos.
        <mediaobject>
		<imageobject>
			<imagedata fileref="./images/icaro-servos.png" />
		</imageobject>
		</mediaobject>
        </para>
        <para>
        Luego de cargar el firmware, la placa &np05; se activará (a los 5 segundos) y el servo, si está correctamente instalado y andando, comenzará a moverse para un lado y para el otro.
        </para>
        

    </section>
</chapter>
